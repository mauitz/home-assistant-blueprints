# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TARJETA DE DASHBOARD PARA PRESENCE SIMULATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# INSTALACIÃ“N:
# 1. Ve a tu Dashboard
# 2. Editar Dashboard â†’ Agregar Tarjeta
# 3. Buscar "Manual" o presionar los 3 puntos â†’ "Editar en YAML"
# 4. Copia y pega este contenido
# 5. Guarda
#
# REQUISITOS:
# - Helpers instalados (presence_simulation_helpers.yaml)
# - Automatizaciones de monitoring activas (presence_simulation_monitoring.yaml)
# - (Opcional) Card-mod para estilos personalizados
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPCIÃ“N 1: TARJETA COMPLETA CON VERTICAL STACK
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
type: vertical-stack
cards:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # HEADER - Estado General
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - type: horizontal-stack
    cards:
      - type: entity
        entity: input_boolean.presence_simulation
        name: Control Principal
        icon: mdi:home-account
        tap_action:
          action: toggle
      
      - type: entity
        entity: input_boolean.presence_simulation_running
        name: Estado
        icon: mdi:information
        tap_action:
          action: none
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # INFORMACIÃ“N PRINCIPAL
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - type: entities
    title: "ğŸ  SimulaciÃ³n de Presencia"
    show_header_toggle: false
    entities:
      # Estado actual
      - entity: input_text.presence_simulation_status
        name: Estado Actual
        icon: mdi:information-outline
      
      # Tiempo activo
      - type: custom:template-entity-row
        entity: sensor.presence_simulation_runtime
        name: Tiempo Activo
        icon: mdi:clock-outline
        state: |
          {% if is_state('input_boolean.presence_simulation_running', 'on') %}
            {% set start_time = states('input_datetime.presence_simulation_start_time') %}
            {% if start_time not in ['unknown', 'unavailable', ''] %}
              {% set start = strptime(start_time, '%Y-%m-%d %H:%M:%S') %}
              {% set duration = now() - start %}
              {% set hours = duration.total_seconds() // 3600 %}
              {% set minutes = (duration.total_seconds() % 3600) // 60 %}
              {{ '%02d:%02d' | format(hours, minutes) }}
            {% else %}
              00:00
            {% endif %}
          {% else %}
            Inactiva
          {% endif %}
        secondary: |
          Desde: {{ states('input_datetime.presence_simulation_start_time') | as_timestamp | timestamp_custom('%d/%m %H:%M', true, 'N/A') }}
      
      # Progreso del loop
      - type: custom:bar-card
        entity: sensor.presence_simulation_progress
        name: Progreso
        height: 30px
        positions:
          icon: "off"
          name: inside
          value: inside
        color: |
          {% set progress = states('sensor.presence_simulation_progress') | int %}
          {% if progress < 30 %}
            rgb(76, 175, 80)
          {% elif progress < 70 %}
            rgb(255, 193, 7)
          {% else %}
            rgb(244, 67, 54)
          {% endif %}
        severity:
          - value: 0
            color: '#4CAF50'
          - value: 50
            color: '#FFC107'
          - value: 100
            color: '#F44336'
      
      # Loops completados
      - type: divider
      
      - entity: input_number.presence_simulation_loop_counter
        name: Loops Completados
        icon: mdi:counter
      
      - entity: input_number.presence_simulation_loop_total
        name: Total de Loops
        icon: mdi:numeric
      
      - type: custom:template-entity-row
        entity: sensor.presence_simulation_time_remaining
        name: Tiempo Restante
        icon: mdi:timer-sand
        state: |
          {% if is_state('input_boolean.presence_simulation_running', 'on') %}
            {% set current = states('input_number.presence_simulation_loop_counter') | int %}
            {% set total = states('input_number.presence_simulation_loop_total') | int %}
            {% if total > 0 and total < 90 %}
              {% set remaining = total - current %}
              {% set minutes_per_loop = 25 %}
              {% set total_minutes = remaining * minutes_per_loop %}
              {% set hours = total_minutes // 60 %}
              {% set mins = total_minutes % 60 %}
              {{ '~%dh %02dm' | format(hours, mins) }}
            {% else %}
              Infinito
            {% endif %}
          {% else %}
            -
          {% endif %}
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # LUCES ACTIVAS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - type: entities
    title: "ğŸ’¡ Luces Activas"
    show_header_toggle: false
    entities:
      # Contador de luces
      - type: custom:template-entity-row
        entity: input_number.presence_simulation_lights_on_count
        name: Luces Encendidas
        icon: mdi:lightbulb-on
        state: |
          {{ states('input_number.presence_simulation_lights_on_count') | int }}
        secondary: |
          MÃ¡ximo configurado: 2
      
      # Lista de luces activas
      - entity: input_text.presence_simulation_active_lights
        name: Dispositivos Activos
        icon: mdi:format-list-bulleted
      
      - type: divider
      
      # Ãšltima luz encendida
      - entity: input_text.presence_simulation_last_light_on
        name: Ãšltima Encendida
        icon: mdi:lightbulb-on-outline
      
      # Ãšltima luz apagada
      - entity: input_text.presence_simulation_last_light_off
        name: Ãšltima Apagada
        icon: mdi:lightbulb-off-outline
      
      # Ãšltima actualizaciÃ³n
      - type: custom:template-entity-row
        entity: input_datetime.presence_simulation_last_update
        name: Ãšltima ActualizaciÃ³n
        icon: mdi:update
        state: |
          {% set last_update = states('input_datetime.presence_simulation_last_update') %}
          {% if last_update not in ['unknown', 'unavailable', ''] %}
            {{ as_timestamp(last_update) | timestamp_custom('%H:%M:%S', true, 'N/A') }}
          {% else %}
            -
          {% endif %}
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # CONTROLES
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - type: horizontal-stack
    cards:
      # BotÃ³n INICIAR
      - type: button
        name: Iniciar
        icon: mdi:play
        tap_action:
          action: call-service
          service: input_boolean.turn_on
          target:
            entity_id: input_boolean.presence_simulation
        hold_action:
          action: none
        show_name: true
        show_icon: true
        icon_height: 40px
        entity: input_boolean.presence_simulation
        state:
          - value: "on"
            color: green
            icon: mdi:play-circle
      
      # BotÃ³n DETENER
      - type: button
        name: Detener
        icon: mdi:stop
        tap_action:
          action: call-service
          service: input_boolean.turn_off
          target:
            entity_id: input_boolean.presence_simulation
        hold_action:
          action: none
        show_name: true
        show_icon: true
        icon_height: 40px
        entity: input_boolean.presence_simulation
        state:
          - value: "off"
            color: red
            icon: mdi:stop-circle

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPCIÃ“N 2: TARJETA SIMPLIFICADA (Sin custom cards)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Si no tienes custom cards instalados, usa esta versiÃ³n:
# 
# type: vertical-stack
# cards:
#   - type: glance
#     title: "ğŸ  SimulaciÃ³n de Presencia"
#     entities:
#       - entity: input_boolean.presence_simulation
#         name: Control
#       - entity: input_boolean.presence_simulation_running
#         name: Estado
#       - entity: input_number.presence_simulation_lights_on_count
#         name: Luces ON
#       - entity: input_number.presence_simulation_loop_counter
#         name: Loops
#   
#   - type: entities
#     title: "InformaciÃ³n Detallada"
#     entities:
#       - entity: input_text.presence_simulation_status
#         name: Estado
#       - entity: input_datetime.presence_simulation_start_time
#         name: Hora Inicio
#       - entity: input_number.presence_simulation_loop_counter
#         name: Loops Completados
#       - entity: input_number.presence_simulation_loop_total
#         name: Total Loops
#       - entity: input_text.presence_simulation_active_lights
#         name: Luces Activas
#       - entity: input_text.presence_simulation_last_light_on
#         name: Ãšltima Encendida
#       - entity: input_text.presence_simulation_last_light_off
#         name: Ãšltima Apagada
#   
#   - type: horizontal-stack
#     cards:
#       - type: button
#         entity: input_boolean.presence_simulation
#         name: Iniciar
#         icon: mdi:play
#         tap_action:
#           action: toggle
#       - type: button
#         entity: input_boolean.presence_simulation
#         name: Detener
#         icon: mdi:stop
#         tap_action:
#           action: turn_off

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPCIÃ“N 3: TARJETA ULTRA-COMPACTA
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Para usar en espacios pequeÃ±os:
#
# type: entities
# title: "ğŸ  SimulaciÃ³n"
# show_header_toggle: false
# entities:
#   - entity: input_boolean.presence_simulation
#     name: Control
#   - entity: input_text.presence_simulation_status
#     name: Estado
#   - entity: input_number.presence_simulation_lights_on_count
#     name: Luces Activas
#   - entity: input_text.presence_simulation_active_lights
#     name: Dispositivos
#   - entity: input_number.presence_simulation_loop_counter
#     name: Loop Actual
#   - type: divider
#   - type: buttons
#     entities:
#       - entity: input_boolean.presence_simulation
#         name: ON/OFF
#         tap_action:
#           action: toggle

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CUSTOM CARDS OPCIONALES (Mejoran la apariencia)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Si quieres la mejor experiencia visual, instala estos custom cards:
#
# 1. template-entity-row
#    https://github.com/thomasloven/lovelace-template-entity-row
#    
# 2. bar-card
#    https://github.com/custom-cards/bar-card
#    
# 3. card-mod (para estilos avanzados)
#    https://github.com/thomasloven/lovelace-card-mod
#
# InstalaciÃ³n via HACS:
# - HACS â†’ Frontend â†’ Buscar el nombre â†’ Instalar
#
# Sin estos, usa la OPCIÃ“N 2 (tarjeta simplificada)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

