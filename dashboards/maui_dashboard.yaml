# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Dashboard Maui V3.2 - Con Sistema de Riego Inteligente
# VersiÃ³n: 3.2
# EstÃ©tica: Minimalista, oscura, profesional
# CaracterÃ­sticas:
#   - Widget de cÃ¡maras se agranda a 2 columnas cuando hay alerta
#   - Vista dedicada para Sistema de Riego Inteligente
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

title: Maui
views:
  - title: Principal
    path: home
    icon: mdi:home
    theme: maui_dark
    type: custom:grid-layout  # â† ESTO HABILITA EL AGRANDAMIENTO
    layout:
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr))
      grid-gap: 16px
    badges: []
    cards:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # TÃTULO: CÃMARAS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: markdown
        content: |
          # CÃ¡maras
        view_layout:
          grid-column: 1 / -1  # Ocupa todo el ancho
        card_mod:
          style: |
            ha-card {
              background: none;
              box-shadow: none;
              margin-bottom: -12px;
            }
            h1 {
              font-size: 18px;
              font-weight: 400;
              margin: 0;
              padding: 0;
              color: #A0A0A0;
              letter-spacing: 0.5px;
            }

      # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      # â”‚ MODO NORMAL: Ambas cÃ¡maras en tamaÃ±o estÃ¡ndar              â”‚
      # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      - type: conditional
        conditions:
          - entity: input_text.camera_alert_active
            state: "none"
        card:
          type: vertical-stack
          cards:
            # CÃ¡mara Entrada
            - type: picture-entity
              entity: camera.tapo_c530ws_entrada_live_view
              camera_view: live
              show_name: true
              show_state: false
              aspect_ratio: "16:9"
              card_mod:
                style: |
                  ha-card {
                    border-radius: 8px;
                    overflow: hidden;
                    border: 1px solid #2A2A2A;
                  }

            # CÃ¡mara Exterior
            - type: picture-entity
              entity: camera.tapo_c310_exterior_live_view
              camera_view: live
              show_name: true
              show_state: false
              aspect_ratio: "16:9"
              card_mod:
                style: |
                  ha-card {
                    border-radius: 8px;
                    overflow: hidden;
                    border: 1px solid #2A2A2A;
                    margin-top: 12px;
                  }

      # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      # â”‚ ALERTA ENTRADA: CÃ¡mara AGRANDADA (ocupa 2 columnas)        â”‚
      # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      - type: conditional
        conditions:
          - entity: input_text.camera_alert_active
            state: "entrada"
        card:
          type: picture-entity
          entity: camera.tapo_c530ws_entrada_live_view
          camera_view: live
          show_name: true
          show_state: false
          aspect_ratio: "21:9"
        view_layout:
          grid-column: span 2  # â† ESTO AGRANDA EL WIDGET A 2 COLUMNAS
        card_mod:
          style: |
            ha-card {
              border-radius: 12px;
              overflow: hidden;
              border: 3px solid #EF4444;
              box-shadow: 0 0 24px rgba(239, 68, 68, 0.5);
              animation: pulse-red 2s ease-in-out infinite;
            }
            @keyframes pulse-red {
              0%, 100% {
                box-shadow: 0 0 24px rgba(239, 68, 68, 0.5);
              }
              50% {
                box-shadow: 0 0 32px rgba(239, 68, 68, 0.8);
              }
            }
            ha-card::before {
              content: "ðŸš¨ DETECCIÃ“N ACTIVA";
              position: absolute;
              top: 12px;
              right: 12px;
              background: rgba(239, 68, 68, 0.9);
              color: white;
              padding: 8px 16px;
              border-radius: 6px;
              font-weight: 600;
              font-size: 14px;
              z-index: 10;
              animation: blink 1s ease-in-out infinite;
            }
            @keyframes blink {
              0%, 100% { opacity: 1; }
              50% { opacity: 0.7; }
            }

      # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      # â”‚ ALERTA EXTERIOR: CÃ¡mara AGRANDADA (ocupa 2 columnas)       â”‚
      # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      - type: conditional
        conditions:
          - entity: input_text.camera_alert_active
            state: "exterior"
        card:
          type: picture-entity
          entity: camera.tapo_c310_exterior_live_view
          camera_view: live
          show_name: true
          show_state: false
          aspect_ratio: "21:9"
        view_layout:
          grid-column: span 2  # â† ESTO AGRANDA EL WIDGET A 2 COLUMNAS
        card_mod:
          style: |
            ha-card {
              border-radius: 12px;
              overflow: hidden;
              border: 3px solid #F97316;
              box-shadow: 0 0 24px rgba(249, 115, 22, 0.5);
              animation: pulse-orange 2s ease-in-out infinite;
            }
            @keyframes pulse-orange {
              0%, 100% {
                box-shadow: 0 0 24px rgba(249, 115, 22, 0.5);
              }
              50% {
                box-shadow: 0 0 32px rgba(249, 115, 22, 0.8);
              }
            }
            ha-card::before {
              content: "ðŸš¨ DETECCIÃ“N ACTIVA";
              position: absolute;
              top: 12px;
              right: 12px;
              background: rgba(249, 115, 22, 0.9);
              color: white;
              padding: 8px 16px;
              border-radius: 6px;
              font-weight: 600;
              font-size: 14px;
              z-index: 10;
              animation: blink 1s ease-in-out infinite;
            }
            @keyframes blink {
              0%, 100% { opacity: 1; }
              50% { opacity: 0.7; }
            }

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # WIDGET: ESTADO DE DETECCIÃ“N FRIGATE V2 (con timestamps)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: vertical-stack
        cards:
          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ TÃTULO PRINCIPAL                                            â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: markdown
            content: |
              ## ðŸ¤– Frigate - Monitoreo en Tiempo Real
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-radius: 12px 12px 0 0;
                  border-bottom: none;
                  padding: 8px 16px 0 16px;
                  box-shadow: none;
                }
                h2 {
                  font-size: 16px;
                  font-weight: 500;
                  margin: 8px 0;
                  color: #E0E0E0;
                }

          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: PERSONAS ðŸ‘¤                                        â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "ðŸ‘¤ DetecciÃ³n de Personas"
            show_header_toggle: false
            entities:
              - entity: binary_sensor.entrada_person_occupancy
                name: "ðŸ“¹ Entrada"
                icon: mdi:cctv
                secondary_info: last-changed
              - entity: binary_sensor.exterior_person_occupancy
                name: "ðŸ“¹ Exterior"
                icon: mdi:cctv
                secondary_info: last-changed
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-top: none;
                  border-bottom: none;
                  border-radius: 0;
                  box-shadow: none;
                  margin-top: -1px;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(66, 165, 245, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #42A5F5;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #42A5F5;
                }
                /* Detectando persona = ROJO */
                .state-on {
                  background: rgba(244, 67, 54, 0.2) !important;
                  animation: pulse-red 2s ease-in-out infinite;
                }
                @keyframes pulse-red {
                  0%, 100% { background: rgba(244, 67, 54, 0.2); }
                  50% { background: rgba(244, 67, 54, 0.35); }
                }
                .state-on .state {
                  color: #F44336 !important;
                  font-weight: 700;
                  font-size: 14px;
                }
                .state-on .entity-name {
                  color: #F44336 !important;
                  font-weight: 600;
                }
                .state-on .state::before {
                  content: "ðŸš¨ ";
                }
                /* No detectando = VERDE */
                .state-off .state {
                  color: #4CAF50 !important;
                  font-weight: 500;
                }
                /* Timestamp mÃ¡s visible cuando ON */
                .state-on .secondary {
                  color: #FF8A80 !important;
                  font-weight: 500;
                }
                /* unavailable */
                .state-unavailable {
                  opacity: 0.4;
                }
                .state-unavailable .state {
                  color: #757575 !important;
                  font-style: italic;
                }

          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: VEHÃCULOS ðŸš—                                       â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "ðŸš— DetecciÃ³n de VehÃ­culos"
            show_header_toggle: false
            entities:
              - entity: binary_sensor.entrada_car_occupancy
                name: "ðŸ“¹ Entrada"
                icon: mdi:cctv
                secondary_info: last-changed
              - entity: binary_sensor.exterior_car_occupancy
                name: "ðŸ“¹ Exterior"
                icon: mdi:cctv
                secondary_info: last-changed
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-top: none;
                  border-bottom: none;
                  border-radius: 0;
                  box-shadow: none;
                  margin-top: -1px;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(255, 152, 0, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #FF9800;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #FF9800;
                }
                /* Detectando vehÃ­culo = NARANJA */
                .state-on {
                  background: rgba(255, 152, 0, 0.2) !important;
                }
                .state-on .state {
                  color: #FF9800 !important;
                  font-weight: 700;
                  font-size: 14px;
                }
                .state-on .entity-name {
                  color: #FF9800 !important;
                  font-weight: 600;
                }
                .state-on .state::before {
                  content: "âš ï¸ ";
                }
                /* No detectando = VERDE */
                .state-off .state {
                  color: #4CAF50 !important;
                  font-weight: 500;
                }
                /* Timestamp */
                .state-on .secondary {
                  color: #FFB74D !important;
                  font-weight: 500;
                }
                .state-unavailable {
                  opacity: 0.4;
                }
                .state-unavailable .state {
                  color: #757575 !important;
                  font-style: italic;
                }

          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: ANIMALES ðŸ• (solo exterior, entrada no soporta)  â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "ðŸ• DetecciÃ³n de Animales (Solo Exterior)"
            show_header_toggle: false
            entities:
              - entity: binary_sensor.exterior_dog_occupancy
                name: "ðŸ• Perro"
                icon: mdi:dog
                secondary_info: last-changed
              - entity: binary_sensor.exterior_cat_occupancy
                name: "ðŸ± Gato"
                icon: mdi:cat
                secondary_info: last-changed
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-radius: 0 0 12px 12px;
                  box-shadow: none;
                  margin-top: -1px;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(156, 39, 176, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #9C27B0;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #9C27B0;
                }
                /* Detectando animal = PÃšRPURA */
                .state-on {
                  background: rgba(156, 39, 176, 0.15) !important;
                }
                .state-on .state {
                  color: #BA68C8 !important;
                  font-weight: 700;
                  font-size: 14px;
                }
                .state-on .entity-name {
                  color: #BA68C8 !important;
                  font-weight: 600;
                }
                .state-on .state::before {
                  content: "ðŸ‘€ ";
                }
                /* No detectando = VERDE */
                .state-off .state {
                  color: #4CAF50 !important;
                  font-weight: 500;
                }
                /* Timestamp */
                .state-on .secondary {
                  color: #CE93D8 !important;
                  font-weight: 500;
                }
                .state-unavailable {
                  opacity: 0.4;
                }
                .state-unavailable .state {
                  color: #757575 !important;
                  font-style: italic;
                }

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # SECCIÃ“N 2: ESCENAS Y CONTROL RÃPIDO
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: markdown
        content: |
          # Escenas y Control
        view_layout:
          grid-column: 1 / -1
        card_mod:
          style: |
            ha-card {
              background: none;
              box-shadow: none;
              margin-bottom: -12px;
              margin-top: 24px;
            }
            h1 {
              font-size: 18px;
              font-weight: 400;
              margin: 0;
              color: #A0A0A0;
              letter-spacing: 0.5px;
            }

      # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      # â”‚ ESCENAS DINÃMICAS - Se generan automÃ¡ticamente             â”‚
      # â”‚ Usa auto-entities para crear un botÃ³n por cada escena      â”‚
      # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      - type: custom:auto-entities
        card:
          type: custom:layout-card
          layout_type: grid
          layout:
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr))
            grid-gap: 16px
        filter:
          include:
            - domain: scene
              options:
                type: custom:button-card
                tap_action:
                  action: call-service
                  service: scene.turn_on
                  service_data:
                    entity_id: this.entity_id
                styles:
                  card:
                    - height: 100px
                    - background: |
                        [[[
                          // Asignar colores segÃºn el icono o nombre
                          const icon = entity.attributes.icon || '';
                          const name = entity.attributes.friendly_name || '';

                          if (icon.includes('sunset-up') || name.toLowerCase().includes('amanecer')) {
                            return 'linear-gradient(135deg, #F59E0B 0%, #FDB813 100%)';
                          } else if (icon.includes('sunset-down') || icon.includes('night') || name.toLowerCase().includes('anoch')) {
                            return 'linear-gradient(135deg, #4F46E5 0%, #6366F1 100%)';
                          } else if (icon.includes('bed') || name.toLowerCase().includes('dormir')) {
                            return 'linear-gradient(135deg, #9333EA 0%, #A855F7 100%)';
                          } else {
                            return 'linear-gradient(135deg, #10B981 0%, #34D399 100%)';
                          }
                        ]]]
                    - border: none
                    - border-radius: 12px
                    - box-shadow: |
                        [[[
                          const icon = entity.attributes.icon || '';
                          const name = entity.attributes.friendly_name || '';

                          if (icon.includes('sunset-up') || name.toLowerCase().includes('amanecer')) {
                            return '0 4px 12px rgba(245, 158, 11, 0.3)';
                          } else if (icon.includes('sunset-down') || icon.includes('night') || name.toLowerCase().includes('anoch')) {
                            return '0 4px 12px rgba(79, 70, 229, 0.3)';
                          } else if (icon.includes('bed') || name.toLowerCase().includes('dormir')) {
                            return '0 4px 12px rgba(147, 51, 234, 0.3)';
                          } else {
                            return '0 4px 12px rgba(16, 185, 129, 0.3)';
                          }
                        ]]]
                  icon:
                    - width: 40px
                    - color: white
                  name:
                    - font-size: 14px
                    - font-weight: 500
                    - color: white
                card_mod:
                  style: |
                    ha-card:hover {
                      transform: translateY(-2px);
                      transition: all 0.3s ease;
                    }
        sort:
          method: friendly_name
        show_empty: false

      # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      # â”‚ CONTROL: SimulaciÃ³n de Presencia ON/OFF                     â”‚
      # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      - type: custom:button-card
        entity: input_boolean.presence_simulation
        name: |
          [[[
            return entity.state === 'on' ? 'Detener SimulaciÃ³n' : 'Iniciar SimulaciÃ³n';
          ]]]
        icon: mdi:home-automation
        tap_action:
          action: toggle
        state:
          - value: 'on'
            styles:
              card:
                - height: 100px
                - background: linear-gradient(135deg, #DC2626 0%, #EF4444 100%)
                - border: 2px solid #DC2626
                - box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4)
              icon:
                - width: 40px
                - color: white
                - animation: pulse 2s ease-in-out infinite
              name:
                - font-size: 14px
                - font-weight: 600
                - color: white
          - value: 'off'
            styles:
              card:
                - height: 100px
                - background: linear-gradient(135deg, #059669 0%, #10B981 100%)
                - border: 2px solid #059669
                - box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4)
              icon:
                - width: 40px
                - color: white
              name:
                - font-size: 14px
                - font-weight: 600
                - color: white
        card_mod:
          style: |
            @keyframes pulse {
              0%, 100% { opacity: 1; }
              50% { opacity: 0.7; }
            }
            ha-card:hover {
              transform: translateY(-2px);
              transition: all 0.3s ease;
            }

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # SECCIÃ“N 3: ÃREAS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: markdown
        content: |
          # Ãreas
        view_layout:
          grid-column: 1 / -1
        card_mod:
          style: |
            ha-card {
              background: none;
              box-shadow: none;
              margin-bottom: -12px;
              margin-top: 24px;
            }
            h1 {
              font-size: 18px;
              font-weight: 400;
              margin: 0;
              color: #A0A0A0;
              letter-spacing: 0.5px;
            }

      - type: custom:button-card
        name: Ver Todas las Ãreas  â†’
        icon: mdi:home-city-outline
        tap_action:
          action: navigate
          navigation_path: /dashboard-areas/0
        styles:
          card:
            - height: 60px
            - background: "linear-gradient(135deg, #1E40AF 0%, #3B82F6 100%)"
            - border: none
            - border-radius: 12px
            - box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3)
            - cursor: pointer
          icon:
            - width: 28px
            - height: 28px
            - color: white
          name:
            - font-size: 14px
            - font-weight: 500
            - color: white
            - letter-spacing: 0.5px
        card_mod:
          style: |
            ha-card:hover {
              background: linear-gradient(135deg, #2563EB 0%, #60A5FA 100%) !important;
              transform: translateY(-2px);
              box-shadow: 0 6px 16px rgba(30, 64, 175, 0.4) !important;
              transition: all 0.3s ease;
            }

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # SECCIÃ“N 4: SIMULACIÃ“N DE PRESENCIA - WIDGET COMPLETO
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: markdown
        content: |
          # SimulaciÃ³n de Presencia
        view_layout:
          grid-column: 1 / -1
        card_mod:
          style: |
            ha-card {
              background: none;
              box-shadow: none;
              margin-bottom: -12px;
              margin-top: 24px;
            }
            h1 {
              font-size: 18px;
              font-weight: 400;
              margin: 0;
              color: #A0A0A0;
              letter-spacing: 0.5px;
            }

      # Widget completo de monitoreo
      - type: vertical-stack
        cards:
          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: ESTADO Y CONTROL                                   â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "ðŸ  Estado y Control"
            show_header_toggle: false
            entities:
              - entity: input_boolean.presence_simulation
                name: "Control Principal"
                icon: mdi:power
              - entity: input_boolean.presence_simulation_running
                name: "Estado EjecuciÃ³n"
                icon: mdi:run
              - entity: input_text.presence_simulation_status
                name: "Estado Actual"
                icon: mdi:information-outline
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-radius: 12px 12px 0 0;
                  box-shadow: none;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(66, 165, 245, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #42A5F5;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #42A5F5;
                }

          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: PROGRESO Y TIEMPO                                  â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "â±ï¸ Progreso y Tiempo"
            show_header_toggle: false
            entities:
              - entity: sensor.presence_simulation_runtime
                name: "Tiempo Activo"
                icon: mdi:timer-outline
              - entity: sensor.presence_simulation_progress
                name: "Progreso"
                icon: mdi:progress-clock
              - entity: input_number.presence_simulation_loop_counter
                name: "Loop Actual"
                icon: mdi:counter
              - entity: input_number.presence_simulation_loop_total
                name: "Loops Totales"
                icon: mdi:format-list-numbered
              - entity: sensor.presence_simulation_time_remaining
                name: "Tiempo Restante"
                icon: mdi:timer-sand
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-top: none;
                  border-radius: 0;
                  box-shadow: none;
                  margin-top: -1px;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(255, 152, 0, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #FF9800;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #FF9800;
                }

          # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          # â”‚ SECCIÃ“N: LUCES ACTIVAS                                      â”‚
          # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          - type: entities
            title: "ðŸ’¡ Luces Activas"
            show_header_toggle: false
            entities:
              - entity: input_number.presence_simulation_lights_on_count
                name: "Cantidad de Luces"
                icon: mdi:lightbulb-multiple
              - entity: input_text.presence_simulation_active_lights
                name: "Dispositivos"
                icon: mdi:format-list-bulleted
              - entity: input_text.presence_simulation_last_light_on
                name: "Ãšltima Encendida"
                icon: mdi:lightbulb-on
              - entity: input_text.presence_simulation_last_light_off
                name: "Ãšltima Apagada"
                icon: mdi:lightbulb-off
            card_mod:
              style: |
                ha-card {
                  background: #1A1A1A;
                  border: 1px solid #2A2A2A;
                  border-radius: 0 0 12px 12px;
                  box-shadow: none;
                  margin-top: -1px;
                }
                .card-header {
                  background: linear-gradient(90deg, rgba(76, 175, 80, 0.15) 0%, transparent 100%);
                  border-left: 4px solid #4CAF50;
                  padding: 12px 16px;
                  font-size: 14px;
                  font-weight: 600;
                  color: #4CAF50;
                }

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VISTA 3: SISTEMA DE RIEGO INTELIGENTE
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Riego
    path: riego
    icon: mdi:sprinkler-variant
    theme: maui_dark
    badges: []
    cards:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # WIDGET PRINCIPAL DE RIEGO - ZONA 1
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: vertical-stack
        cards:
          # Cabecera - Estado General
          - type: glance
            title: ðŸš° Sistema de Riego - Zona 1
            show_name: true
            show_state: true
            columns: 3
            entities:
              - entity: sensor.riego_z1_humedad_suelo_z1
                name: Humedad
              - entity: sensor.riego_z1_nivel_tanque
                name: Tanque
              - entity: sensor.riego_z1_luz_ambiente
                name: Luz

          # Estado del Sistema
          - type: markdown
            content: >
              {% set humedad = states('sensor.riego_z1_humedad_suelo_z1') | float(0) %}
              {% set tanque = states('sensor.riego_z1_nivel_tanque') | float(0) %}
              {% set bomba_a = is_state('switch.riego_z1_bomba_z1a', 'on') %}
              {% set bomba_b = is_state('switch.riego_z1_bomba_z1b', 'on') %}

              {% if bomba_a or bomba_b %}
                ### ðŸ’§ **Regando Ahora**
                - Humedad actual: **{{ humedad }}%**
                - Nivel tanque: **{{ tanque }}%**
              {% elif tanque < 20 %}
                ### âš ï¸ **Tanque Bajo**
                - Tanque: **{{ tanque }}%**
                - Sistema detenido hasta rellenar
              {% elif humedad < 30 %}
                ### ðŸŒµ **Suelo Seco**
                - Humedad: **{{ humedad }}%**
                - Esperando horario de riego
              {% else %}
                ### âœ… **Sistema OK**
                - Humedad: **{{ humedad }}%**
                - Tanque: **{{ tanque }}%**
                - Sistema automÃ¡tico activo
              {% endif %}

          # GrÃ¡fico de Humedad
          - type: history-graph
            title: ðŸ“Š Humedad del Suelo (24h)
            hours_to_show: 24
            refresh_interval: 60
            entities:
              - entity: sensor.riego_z1_humedad_suelo_z1
                name: Humedad Suelo

          # Controles de Bombas
          - type: entities
            title: ðŸ’§ Control de Bombas
            show_header_toggle: false
            entities:
              - entity: switch.riego_z1_bomba_z1a
                name: Bomba Z1A
                icon: mdi:water-pump
                secondary_info: last-changed
              - entity: switch.riego_z1_bomba_z1b
                name: Bomba Z1B
                icon: mdi:water-pump
                secondary_info: last-changed
              - type: divider
              - entity: light.riego_z1_led_bomba_activa
                name: LED Indicador
                icon: mdi:led-on

          # Sensores Ambientales
          - type: entities
            title: ðŸŒ¡ï¸ Sensores Ambientales
            show_header_toggle: false
            entities:
              - entity: sensor.riego_z1_temperatura_ambiente
                name: Temperatura
                icon: mdi:thermometer
              - entity: sensor.riego_z1_humedad_ambiente
                name: Humedad Ambiente
                icon: mdi:water-percent
              - entity: sensor.riego_z1_luz_ambiente
                name: Luz Ambiente
                icon: mdi:weather-sunny
              - entity: binary_sensor.riego_z1_presencia_detectada
                name: Presencia (LD2410C)
                icon: mdi:motion-sensor

          # LEDs de Estado
          - type: entities
            title: ðŸ’¡ Indicadores LED
            show_header_toggle: false
            entities:
              - entity: light.riego_z1_led_tanque_lleno
                name: LED Tanque Lleno
                icon: mdi:water-check
              - entity: light.riego_z1_led_tanque_medio
                name: LED Tanque Medio
                icon: mdi:water-minus
              - entity: light.riego_z1_led_tanque_bajo
                name: LED Tanque Bajo
                icon: mdi:water-alert
              - entity: light.riego_z1_led_wifi
                name: LED WiFi
                icon: mdi:wifi

          # Control Manual y Scripts
          - type: entities
            title: âš™ï¸ Control Manual
            show_header_toggle: false
            entities:
              - entity: input_boolean.riego_z1_manual
                name: Modo Manual
                icon: mdi:hand-back-right
              - type: divider
              - type: button
                name: ðŸš° Regar 5 minutos
                icon: mdi:timer-10
                tap_action:
                  action: call-service
                  service: script.riego_manual_5min
              - type: button
                name: ðŸš° Regar 10 minutos
                icon: mdi:timer-outline
                tap_action:
                  action: call-service
                  service: script.riego_manual_10min
              - type: button
                name: â›” Detener Todo
                icon: mdi:stop
                tap_action:
                  action: call-service
                  service: script.detener_todas_bombas
              - type: divider
              - entity: automation.riego_automatico_zona_1
                name: AutomatizaciÃ³n
                icon: mdi:robot

          # Indicadores Gauge
          - type: gauge
            entity: sensor.riego_z1_humedad_suelo_z1
            name: Humedad del Suelo
            min: 0
            max: 100
            needle: true
            severity:
              green: 60
              yellow: 40
              red: 0

          - type: gauge
            entity: sensor.riego_z1_nivel_tanque
            name: Nivel del Tanque
            min: 0
            max: 100
            needle: true
            severity:
              green: 50
              yellow: 30
              red: 0

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # TÃTULO: INFORMACIÃ“N DEL SISTEMA
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: markdown
        content: |
          # ðŸ“¡ InformaciÃ³n del Sistema
        card_mod:
          style: |
            ha-card {
              background: none;
              box-shadow: none;
              margin-top: 24px;
              margin-bottom: -12px;
            }
            h1 {
              font-size: 18px;
              font-weight: 400;
              margin: 0;
              padding: 0;
              color: #A0A0A0;
              letter-spacing: 0.5px;
            }

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # INFORMACIÃ“N DEL ESP32
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - type: entities
        title: ESP32 - Riego Z1
        show_header_toggle: false
        entities:
          - entity: binary_sensor.riego_z1_estado_conexion
            name: Estado ConexiÃ³n
            icon: mdi:wifi
          - entity: sensor.riego_z1_wifi_signal
            name: SeÃ±al WiFi
            icon: mdi:wifi-strength-4
          - entity: button.riego_z1_reiniciar_esp32
            name: Reiniciar ESP32
            icon: mdi:restart
        card_mod:
          style: |
            ha-card {
              background: #1A1A1A;
              border: 1px solid #2A2A2A;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            }

